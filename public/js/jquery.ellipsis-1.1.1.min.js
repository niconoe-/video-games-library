(function(e){e.fn.ellipsis=function(t){var n={row:1,onlyFullWords:false,"char":"...",callback:function(){},position:"tail"};t=e.extend(n,t);this.each(function(){var n=e(this);var r=n.text();var i=r;var s=i.length;var o=n.height();n.text("a");var u=parseFloat(n.css("lineHeight"),10);var a=n.height();var f=u>a?u-a:0;var l=f*(t.row-1)+a*t.row;if(o<=l){n.text(r);t.callback.call(this);return}var c=1,h=0;var p=r.length;if(t.position==="tail"){while(c<p){h=Math.ceil((c+p)/2);n.text(r.slice(0,h)+t["char"]);if(n.height()<=l){c=h}else{p=h-1}}r=r.slice(0,c);if(t.onlyFullWords){r=r.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")}r+=t["char"]}else if(t.position==="middle"){var d=0;while(c<p){h=Math.ceil((c+p)/2);d=Math.max(s-h,0);n.text(i.slice(0,Math.floor((s-d)/2))+t["char"]+i.slice(Math.floor((s+d)/2),s));if(n.height()<=l){c=h}else{p=h-1}}d=Math.max(s-c,0);var v=i.slice(0,Math.floor((s-d)/2));var m=i.slice(Math.floor((s+d)/2),s);if(t.onlyFullWords){v=v.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")}r=v+t["char"]+m}n.text(r);t.callback.call(this)});return this}})(jQuery)