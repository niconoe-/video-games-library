(function(e){e.fn.ellipsis=function(t){var n={row:1,allowFullText:false,onlyFullWords:false,"char":"â€¦",callback:function(){},position:"tail"};t=e.extend(n,t);this.each(function(){var n=e(this);var r=n.text();var i=r;var s=r;var o=s.length;var u=n.height();n.text("a");var a=parseFloat(n.css("lineHeight"),10);var f=n.height();var l=a>f?a-f:0;var c=l*(t.row-1)+f*t.row;if(u<=c){n.text(r);t.callback.call(this);return}var h=1,p=0;var d=r.length;var v=t["char"];if(t.allowFullText){v='<a href="#" data-ellipsis-full>'+v+"</a>"}if(t.position==="tail"){while(h<d){p=Math.ceil((h+d)/2);n.text(r.slice(0,p)+t["char"]);if(n.height()<=c){h=p}else{d=p-1}}r=r.slice(0,h);if(t.onlyFullWords){r=r.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")}r+=v}else if(t.position==="middle"){var m=0;while(h<d){p=Math.ceil((h+d)/2);m=Math.max(o-p,0);n.text(s.slice(0,Math.floor((o-m)/2))+v+s.slice(Math.floor((o+m)/2),o));if(n.height()<=c){h=p}else{d=p-1}}m=Math.max(o-h,0);var g=s.slice(0,Math.floor((o-m)/2));var y=s.slice(Math.floor((o+m)/2),o);if(t.onlyFullWords){g=g.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")}r=g+v+y}n.html(r);if(t.allowFullText){var b=n.prop("tagName").toLowerCase();n.after("<"+b+">"+i+"</"+b+">");n.next().hide();n.find("a[data-ellipsis-full]").bind("click",function(t){t.preventDefault();e(this).parent().hide().next().show();return false})}t.callback.call(this)});return this}})(jQuery)